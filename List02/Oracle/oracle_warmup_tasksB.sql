--------------------------------------------------------------------------------
-- TASK 6
--------------------------------------------------------------------------------
WITH Kocury_typy AS (
    SELECT 
        pseudo,
        przydzial_myszy,
        nr_bandy,
        CASE 
            WHEN przydzial_myszy > AVG(przydzial_myszy) OVER () 
                THEN 'Prominent'
            WHEN przydzial_myszy = MIN(przydzial_myszy) OVER (PARTITION BY nr_bandy)
                THEN 'Szarak'
        END "Typ"
    FROM Kocury
)

SELECT
    pseudo          "Pseudonim",
    przydzial_myszy "Zjada",
    nr_bandy        "Banda",
    "Typ"
FROM
    Kocury_typy
WHERE
    "Typ" IS NOT NULL
ORDER BY
    "Typ", nr_bandy;

--------------------------------------------------------------------------------
-- TASK 7
--------------------------------------------------------------------------------


--------------------------------------------------------------------------------
-- TASK 8
--------------------------------------------------------------------------------


--------------------------------------------------------------------------------
-- TASK 9
--------------------------------------------------------------------------------


--------------------------------------------------------------------------------
-- TASK 10
--------------------------------------------------------------------------------


--------------------------------------------------------------------------------
-- TASK 11
--------------------------------------------------------------------------------

